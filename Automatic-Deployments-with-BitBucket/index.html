<!DOCTYPE html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js"><!--<![endif]--><head><meta charset="utf-8"><title>Automatic Deployments with BitBucket - Alfredo Llanos</title><meta charset="utf-8"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="description" content=""><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="stylesheet" href="../build/style.un.min.css"><link href="http://fonts.googleapis.com/css?family=Arvo:700,700italic|Roboto:400italic,100,300,100italic,300italic,400" rel="stylesheet" type="text/css"><script src="//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.0.0/isotope.pkgd.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/snap.svg/0.3.0/snap.svg-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script></head><body><div class="loader"><div class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div></div><div class="nav-container"><nav class="top-bar overlay-bar offscreen-menu drop-shadow"><div class="container"><div class="row utility-menu"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div class="utility-inner clearfix"><span class="alt-font btn-sm"><i class="icon icon_pin"></i> Bilbao | 43.2569° N, 2.9236° W</span><div class="pull-right"><ul class="social-icons text-right"><li><a href="https://twitter.com/biojazzard"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.facebook.com/alfredo.llanos"><i class="fa fa-facebook"></i></a></li><li><a href="https://plus.google.com/+AlfredoLlanos/"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div class="row nav-menu"><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2"><a href="/"><div id="logo" class="logo" data-src="http://biojazzard.github.io/img/dot-a.svg" data-desc="DOT-A Alfredo Llanos"></div></a></div><div class="col-sm-9 col-sm-9 col-md-10 col-lg-10"><div class="offscreen-toggle"><i class="icon icon_menu text-white pull-right"></i></div></div></div></div><div class="offscreen-container"><div class="made-with">Made with Love ...</div><div id="smiley" class="smiley" data-src="http://biojazzard.github.io/img/smiley.svg" data-desc="smiley"></div><div class="made-with to-bottom">and some acid tracks!,</div></div></nav></div><div class="main-container"><header class="title"><div class="background-image-holder parallax-background"><img class="background-image" alt="Background Image" src="http://biojazzard.github.io/img/hero10.jpg"></div><div class="container align-bottom"><div class="row"><div class="col-xs-12"><h1 class="text-white">Automatic Deployments with BitBucket</h1><p><span class="sub alt-font text-white">15 November, 2014</span></p></div></div></div></header><section class="article-single"><div class="container"><div class="row"><div class="col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1"><div class="article-body"><p><em>Unas notas de como automatizar el deploy de sitios web con git y bitbucket hooks.</em></p><p>Este artículo está inspirado en este otro <a href="http://brandonsummers.name/blog/2012/02/10/using-bitbucket-for-automated-deployments/">artículo</a>.</p><h1>Objetivo</h1><p>Desarollamos un sitio web. Al hacer commit al proyecto web, es publicado automáticamente.</p><h1>Necesario tener o saber</h1><ul><li>Local: Desarrollar un proyecto usando GIT.<ul><li>Software:<ul><li><a href="http://git-scm.com/">GIT</a></li><li><a href="http://www.openssh.com/">SSH</a></li></ul></li></ul></li><li>Servidor: Donde se publica.<ul><li>Software:<ul><li><a href="http://www.apache.org/">Apache</a></li><li><a href="http://php.net/">PHP</a></li><li><a href="http://git-scm.com/">GIT</a></li><li><a href="http://www.openssh.com/">SSH</a></li></ul></li><li>Cuenta con acceso SSH en el servidor.</li></ul></li><li>Repositorio:<ul><li>Cuenta en:<ul><li><a href="https://bitbucket.org/">bitbucket</a> ó</li><li><a href="https://github.com/">github</a></li></ul></li></ul></li></ul><h2>Flujo de Trabajo</h2><p>Básicamente lo que queremos es que cuando hagamos en nuestra máquina local de desarrollo:</p><p><code>git commit</code> (consolidar el proyecto) + <code>git push</code> (subir cambios al repositorio)</p><p>El proyecto se actualice automáticamente en <a href="http://domain.com">http://domain.com</a></p><h2>Ahorro</h2><p>Repetir una secuencia de tareas repetidamente.</p><p>Queremos que nuestro servidor de destino haga algo automaticamente, y evitarnos hacer a mano cosas como:</p><p><code>git pull</code> (traer los cambiso del repositorio === actualizar el proyecto en el web)</p><p>El problema es que para ejecutar ese simple comando, haya que hacer antes:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Entrar al servidor</span>
<span class="nv">$ </span>ssh user:domain.com
<span class="c"># Ir al directorio del proyecto</span>
<span class="nv">$ </span><span class="nb">cd</span> /home/machine/domains/domain.com/html
<span class="c"># Ver cómo estamos</span>
<span class="nv">$ </span>git status
<span class="c"># Descartar cambios locales</span>
<span class="nv">$ </span>git reset --hard HEAD
<span class="c"># Actualizar web</span>
<span class="nv">$ </span>git pull origin master
</code></pre></div><p>Cada vez que queramos mostrar cambios.... &gt;_&lt;</p><p>Teniendo en cuenta, que requiere introducir tanto el <em>password</em> del servidor, como el <em>passphrase</em> de tu clave.</p><h1>Procedimiento</h1><h2>Necesitamos:</h2><ul><li>Usar <a href="https://bitbucket.org/">bitbucket</a> para alojar nuestro repositorio.</li><li>Utilizar los <a href="https://confluence.atlassian.com/display/BITBUCKET/POST+hook+management">hooks</a> de <a href="https://bitbucket.org/">bitbucket</a></li><li>Configurar y añadir al proyecto, el archivo <a href="#deploy">deploy.php</a>. Tambien disponible como <a href="https://gist.github.com/c0123f6797aaeb935ccd.git">gist:deploy.php</a></li><li>Crear las claves, añadirlas a bitbucket y establecer los permisos necesarios en el servidor de destino.</li></ul><h3>Aloja tu proyecto en <a href="https://bitbucket.org/">bitbucket</a></h3><p>Se escapa del alcance del post, sigue las instrucciones en la propia web, es muy sencillo.</p><h3>Creación de un hook para tu proyecto en bitbucket:</h3><p>La configuración de todo esto, en bitbucket: <code>Tu Proyecto &gt; Settings &gt; Hooks</code></p><div class="highlight"><pre><code class="language-text" data-lang="text"># La URL de configuración de los hooks es algo así:
# user.name: tu nombre de usuario de [bitbucket](https://bitbucket.org/)
# project.name: tu proyecto.
https://bitbucket.org/user.name/project.name/admin/hooks
</code></pre></div><ul><li>Suponiendo que publicas la web en <a href="http://domain.com/">domain.com</a></li></ul><div class="highlight"><pre><code class="language-text" data-lang="text"># URL para tu hook;
http://domain.com/deploy.php
</code></pre></div><h3>Archivo <code>deploy.php</code></h3><p>Lo deberás añadir a la raíz de tu proyecto, y no olvides de <code>git add deploy.php</code> para que no se quede fuera.</p><p><a id="deploy"></a></p><div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="c1"># Originally seen here: &#39;Using Bitbucket for Automated Deployments&#39;</span>
<span class="c1"># http://brandonsummers.name/blog/2012/02/10/using-bitbucket-for-automated-deployments/</span>

<span class="c1"># Is it safe servers time ?</span>
<span class="c1">#date_default_timezone_set(&#39;America/Los_Angeles&#39;);</span>

<span class="k">class</span> <span class="nc">Deploy</span> <span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">    * A callback function to call after the deploy has finished.</span>
<span class="sd">    *</span>
<span class="sd">    * @var callback</span>
<span class="sd">    */</span>

    <span class="k">public</span> <span class="nv">$post_deploy</span><span class="p">;</span>
    <span class="sd">/**</span>
<span class="sd">    * The name of the file that will be used for logging deployments. Set to * FALSE to disable logging.</span>
<span class="sd">    *</span>
<span class="sd">    * @var string </span>
<span class="sd">    */</span>

    <span class="k">private</span> <span class="nv">$_log</span> <span class="o">=</span> <span class="s1">&#39;deployments.log&#39;</span><span class="p">;</span>
    <span class="sd">/**</span>
<span class="sd">    * The timestamp format used for logging.</span>
<span class="sd">    *</span>
<span class="sd">    * @link http://www.php.net/manual/en/function.date.php</span>
<span class="sd">    * @var string</span>
<span class="sd">    */</span>

    <span class="k">private</span> <span class="nv">$_date_format</span> <span class="o">=</span> <span class="s1">&#39;Y-m-d H:i:sP&#39;</span><span class="p">;</span>
    <span class="sd">/**</span>
<span class="sd">    * The name of the branch to pull from.</span>
<span class="sd">    *</span>
<span class="sd">    * @var string</span>
<span class="sd">    */</span>

    <span class="k">private</span> <span class="nv">$_branch</span> <span class="o">=</span> <span class="s1">&#39;master&#39;</span><span class="p">;</span>
    <span class="sd">/**</span>
<span class="sd">    * The name of the remote to pull from.</span>
<span class="sd">    *</span>
<span class="sd">    * @var string</span>
<span class="sd">    */</span>

    <span class="k">private</span> <span class="nv">$_remote</span> <span class="o">=</span> <span class="s1">&#39;origin&#39;</span><span class="p">;</span>
    <span class="sd">/**</span>
<span class="sd">    * The directory where your website and git repository are located, can be * a relative or absolute path</span>
<span class="sd">    *</span>
<span class="sd">    * @var string</span>
<span class="sd">    */</span>
    <span class="k">private</span> <span class="nv">$_directory</span><span class="p">;</span>
    <span class="sd">/** * Sets up defaults.</span>
<span class="sd">    *</span>
<span class="sd">    * @param string $directory Directory where your website is located</span>
<span class="sd">    * @param array $data Information about the deployment</span>
<span class="sd">    */</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span> <span class="p">(</span><span class="nv">$directory</span><span class="p">,</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{</span>
        <span class="c1">// Determine the directory path</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_directory</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$directory</span><span class="p">)</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span>

        <span class="nv">$available_options</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;date_format&#39;</span><span class="p">,</span> <span class="s1">&#39;branch&#39;</span><span class="p">,</span> <span class="s1">&#39;remote&#39;</span><span class="p">);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$options</span> <span class="k">as</span> <span class="nv">$option</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$option</span><span class="p">,</span> <span class="nv">$available_options</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nv">$option</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Attempting deployment...&#39;</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">    * Writes a message to the log file.</span>
<span class="sd">    *</span>
<span class="sd">    * @param string $message The message to write</span>
<span class="sd">    * @param string $type The type of log message (e.g. INFO, DEBUG, ERROR, etc.)</span>
<span class="sd">    */</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">log</span><span class="p">(</span><span class="nv">$message</span><span class="p">,</span> <span class="nv">$type</span> <span class="o">=</span> <span class="s1">&#39;INFO&#39;</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_log</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Set the name of the log file</span>
                <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_log</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">file_exists</span><span class="p">(</span><span class="nv">$filename</span><span class="p">))</span> <span class="p">{</span>

                <span class="c1">// Create the log file</span>
                <span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>

                <span class="c1">// Allow anyone to write to log files</span>
                <span class="nb">chmod</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="mo">0666</span><span class="p">);</span> <span class="p">}</span>

                <span class="c1">// Write the message into the log file</span>
                <span class="c1">// Format: time --- type: message</span>
                <span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nb">date</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_date_format</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; --- &#39;</span><span class="o">.</span><span class="nv">$type</span><span class="o">.</span><span class="s1">&#39;: &#39;</span><span class="o">.</span><span class="nv">$message</span><span class="o">.</span><span class="nx">PHP_EOL</span><span class="p">,</span> <span class="nx">FILE_APPEND</span><span class="p">);</span>
            <span class="p">}</span> 

        <span class="p">}</span>
        <span class="sd">/**</span>
<span class="sd">        * Executes the necessary commands to deploy the website.</span>
<span class="sd">        */</span>

        <span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="c1">// Make sure we&#39;re in the right directory</span>
                <span class="c1">//exec(&#39;cd &#39;.$this-&gt;_directory, $output);</span>
                <span class="nb">chdir</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_directory</span><span class="p">);</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Changing working directory... &#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$output</span><span class="p">));</span>
                <span class="c1">// Discard any changes to tracked files since our last deploy</span>
                <span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;git reset --hard HEAD&#39;</span><span class="p">,</span> <span class="nv">$output</span><span class="p">);</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Reseting repository... &#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$output</span><span class="p">));</span> <span class="c1">// Update the local repository</span>

                <span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;git pull &#39;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_remote</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_branch</span><span class="p">,</span> <span class="nv">$output</span><span class="p">);</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Pulling in changes... &#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$output</span><span class="p">));</span>

                <span class="c1">// Secure the .git directory</span>
                <span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;chmod -R og-rx .git&#39;</span><span class="p">);</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Securing .git directory... &#39;</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">post_deploy</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nb">call_user_func</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">post_deploy</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_data</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Deployment successful.&#39;</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="nv">$e</span><span class="p">,</span> <span class="s1">&#39;ERROR&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// This is just an example</span>
<span class="nv">$deploy</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Deploy</span><span class="p">(</span><span class="s1">&#39;/home/machine/domains/domain.com/html&#39;</span><span class="p">);</span>
<span class="nv">$deploy</span><span class="o">-&gt;</span><span class="na">post_deploy</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$deploy</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// hit the wp-admin page to update any db changes</span>
    <span class="c1">//exec(&#39;curl http://www.foobar.com/wp-admin/upgrade.php?step=upgrade_db&#39;);</span>
    <span class="nv">$deploy</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Biojazzard´s GIT PULL ... &#39;</span><span class="p">);</span>
<span class="p">};</span>
<span class="c1">// Doit</span>
<span class="nv">$deploy</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div><h3>Configuración de <code>deploy.php</code>en tu proyecto web.</h3><ul><li>Coloca <a href="#deploy">deploy.php</a> en la raíz de tu proyecto web, recuerda que has configurado el hook para que llame a:</li></ul><div class="highlight"><pre><code class="language-text" data-lang="text"># Hook URL
http://domain.com/deploy.php
</code></pre></div><ul><li>Configura <a href="#deploy">deploy.php</a></li></ul><p>Configura tu branch del proyecto.</p><div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="c1">// ...</span>
<span class="k">private</span> <span class="nv">$_branch</span> <span class="o">=</span> <span class="s1">&#39;master&#39;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div><p>Configura el origen del repositorio.</p><div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="c1">// ...</span>
<span class="k">private</span> <span class="nv">$_remote</span> <span class="o">=</span> <span class="s1">&#39;origin&#39;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div><p>Y lo más importante: la ruta al proyecto: depende de tu servidor y suele ser del tipo:</p><div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="c1">// ...</span>
<span class="nv">$deploy</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Deploy</span><span class="p">(</span><span class="s1">&#39;/home/machine/domains/domain.com/html&#39;</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div><h1>Configuración SSH, Deployment Keys y Permisos</h1><p>En estos momentos, ya podrás hacer un <code>git commit</code> y <code>git push</code>: `<code>deploy.php</code> será atacado, pero no se te actualizará el proyecto. &gt;_&lt;</p><p>Queda:</p><h2>SSH</h2><ul><li>Si tu par de keys, tiene una <em>passphrase</em>, no te servirá. Para ello:</li></ul><p>Conectate a tu servidor vía SSH y genera un par, no establezcas ninguna <em>passphrase</em></p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>ssh-keygen -t rsa
</code></pre></div><p>Copia el contenido de la clave que se te muestra al abrir la clave pública:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>cat ~/.ssh/id_rsa.pub
</code></pre></div><h2>Deployment Keys en bitbucket</h2><p>Y pegalo en el contenido de la <em>key</em> que generes para el proyecto: para ello vete a bitbucket, abre tu proyecto, vete a <code>Tu proyecto &gt; Settings &gt; Deployment Keys</code></p><div class="highlight"><pre><code class="language-text" data-lang="text"># La URL es del tipo:
https://bitbucket.org/biojazzard/demo.psicotecnico/admin/deploy-keys
</code></pre></div><h2>Permisos</h2><p>Lo único que falta, es hacer que tu servidor <em>Apache</em>, tenga el permiso necesario para ver tu clave pública, es necesario entonces que asignes los permisos necesarios a la carpeta `<code>.ssh</code></p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>chown -R www-data:www-data .ssh
</code></pre></div><p>En mi caso el usuario apache es <code>www-data</code> en tu caso puede ser diferente:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>chown -R apache:apache .ssh
</code></pre></div><h1>Consejos</h1><ul><li>Mira el log <code>deployment.log</code> con frecuencia: te puede dar pistas de o que esté pasando.</li><li>En estos casos los asuntos suelen venir siempre de permisos <em>chungos</em>.</li></ul><h2>Recursos</h2><ul><li><a href="https://gist.github.com/biojazzard/c0123f6797aaeb935ccd">deploy.php</a></li></ul><h2>Más información</h2><ul><li><p><a href="http://brandonsummers.name/blog/2012/02/10/using-bitbucket-for-automated-deployments/">bitbucket-for-automated-deployments</a> https://confluence.atlassian.com/display/BITBUCKET/POST+hook+management</p></li><li><p><a href="https://confluence.atlassian.com/display/BITBUCKET/Add+an+SSH+key+to+an+account#AddanSSHkeytoanaccount-Testingwhichkeyyouaresending">Add an SSH key to an account</a></p></li><li><p><a href="https://confluence.atlassian.com/pages/viewpage.action?pageId=270827678">Set up SSH for Git and Mercurial on Mac OSX/Linux</a></p></li><li><p><a href="https://confluence.atlassian.com/pages/viewpage.action?pageId=271943168#ConfiguremultipleSSHidentitiesforGitBash,MacOSX,&amp;Linux-LoadeachkeyintotheappropriateBitbucketaccount">Configure multiple SSH identities for GitBash, Mac OSX, &amp; Linux</a></p></li></ul></div></div></div><div class="row"><div class="col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2"><div class="author-details"><div id="logo-author" class="logo-author" data-src="http://biojazzard.github.io/img/dot-a.svg" data-desc="DOT-A Alfredo Llanos"></div><h5>Alfredo Llanos</h5><p>Web Developer. Bilbao</p><ul class="social-icons text-right"><li><a href="https://twitter.com/biojazzard"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.facebook.com/alfredo.llanos"><i class="fa fa-facebook"></i></a></li><li><a href="https://plus.google.com/+AlfredoLlanos/"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div></section></div><div class="footer-container"><footer class="details"><div class="container"><div class="row ui-sortable"><div class="col-sm-12"><span class="sub">© 2014 <a href="#">Alfredo Llanos</a> &nbsp;- Todos los derechos reservados.</span></div></div></div></footer></div><script src="https://www.youtube.com/iframe_api"></script><script src="../build/build.min.js"></script></body></html>